"use client";

import { useEffect } from "react";
import Divider from "./Divider";
import Button from "./Button";

export default function Modal({
  isOpen,
  onClose,
  onConfirm,
  title,
  confirmText,
  cancelText,
  children,
}) {
  // Close on Escape key
  useEffect(() => {
    const handleEscape = (e) => {
      if (e.key === "Escape") onClose();
    };

    if (isOpen) {
      document.addEventListener("keydown", handleEscape);
      document.body.style.overflow = "hidden"; // Prevent background scroll
    }

    return () => {
      document.removeEventListener("keydown", handleEscape);
      document.body.style.overflow = "";
    };
  }, [isOpen, onClose]);

  if (!isOpen) return null;

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center">
      {/* Backdrop */}
      <div className="absolute inset-0 bg-black/50" onClick={onClose} />

      {/* Modal content */}
      <div className="relative bg-white py-10 rounded-lg max-w-sm w-full mx-4 shadow-xl flex flex-col items-center justify-center">
        <svg
          className=" mb-4"
          width={198}
          height={206}
          viewBox="0 0 198 206"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g clipPath="url(#clip0_12_740)">
            <path d="M198 204.21H0V205.217H198V204.21Z" fill="#F2F2F2" />
            <path
              d="M51.8492 190.778H33.4897V204.713H51.8492V190.778Z"
              fill="#F2F2F2"
            />
            <path
              d="M159.293 190.778H140.933V204.713H159.293V190.778Z"
              fill="#F2F2F2"
            />
            <path
              d="M135.496 45.8069C135.496 45.8069 36.084 35.4678 33.8464 53.8985C31.6088 72.3292 31.1596 83.1175 36.9815 87.1632C36.9815 87.1632 56.0128 104.47 46.1614 119.751L40.7878 128.743L147.458 126.945C147.458 126.945 149.697 94.1303 156.414 87.8367C163.13 81.5431 165.369 48.2784 156.414 47.3806C147.458 46.4827 145.794 44.9083 135.496 45.8069Z"
              fill="#E6E6E6"
            />
            <path
              d="M41.8837 86.0396C41.8837 86.0396 10.6112 100.872 23.0314 128.744L25.0265 132.789L24.1393 194.823H168.304L169.856 134.137L171.631 126.945C171.631 126.945 182.68 100.086 150.762 90.3651L145.016 119.752L47.8718 118.405C47.8718 118.405 47.2066 85.1404 41.8837 86.0396Z"
              fill="#E6E6E6"
            />
            <path
              d="M146.866 119.978C146.866 119.978 103.03 88.7351 48.3992 120.203L32.2791 143.578L35.4142 162.907C35.4142 162.907 148.706 164.705 150.049 152.568C151.393 140.431 146.866 119.978 146.866 119.978Z"
              fill="#E6E6E6"
            />
            <path
              opacity={0.049}
              d="M149.496 120.995C149.422 120.628 103.03 88.7359 48.3992 120.204L32.2791 143.579L35.4142 162.909C35.4142 162.909 145.116 165.251 152.164 154.177L149.496 120.995Z"
              fill="#090814"
            />
            <path
              opacity={0.049}
              d="M40.7876 58.1695C62.5515 57.704 83.1834 54.931 102.135 48.7279C102.596 70.6111 105.73 91.0772 112.882 109.413C91.695 105.548 70.1918 109.373 48.4016 120.202C52.3137 100.421 48.9301 79.6256 40.7876 58.1695Z"
              fill="#090814"
            />
            <path
              opacity={0.049}
              d="M149.739 69.5502C131.909 65.0514 112.291 59.0018 94.9186 60.5434C89.4088 78.8883 91.7056 100.953 85.3137 118.45C104.246 114.762 142.935 128.744 142.935 128.744C142.935 128.744 150.975 89.3205 149.739 69.5502Z"
              fill="#090814"
            />
            <path
              d="M126.99 162.959L122.066 173.034C122.066 173.034 113.166 171.894 116.765 183.68C116.765 183.68 115.818 192.614 113.925 194.515C112.031 196.416 115.44 208.963 122.257 205.35C126.091 203.319 126.332 200.986 125.807 199.334C124.993 196.871 124.835 194.237 125.346 191.693C126.098 187.866 127.486 184.194 129.452 180.829C133.807 173.796 137.973 166.953 137.973 166.953L126.99 162.959Z"
              fill="#ED9DA0"
            />
            <path
              d="M114.681 100.988C114.681 100.988 103.887 98.3272 100.288 100.228C96.6886 102.128 86.0857 102.319 86.0857 102.319C86.0857 102.319 77.1856 116.767 79.2685 124.18C81.3514 131.592 90.0624 136.156 90.0624 136.156L119.414 136.346L124.148 116.956C124.148 116.956 121.876 103.649 119.982 102.889C118.088 102.128 114.681 100.988 114.681 100.988Z"
              fill="#090814"
            />
            <path
              d="M102.876 52.1503C110.579 52.1503 116.824 45.8814 116.824 38.1483C116.824 30.4152 110.579 24.1463 102.876 24.1463C95.1723 24.1463 88.9275 30.4152 88.9275 38.1483C88.9275 45.8814 95.1723 52.1503 102.876 52.1503Z"
              fill="#090814"
            />
            <path
              d="M94.9873 48.5215C94.9873 48.5215 96.8809 56.5055 94.0404 57.456C91.2 58.4064 88.7393 62.2083 88.7393 62.2083L92.905 69.242L107.107 72.8539L111.463 68.6718L114.683 59.7374L111.463 57.4562C111.463 57.4562 108.433 58.4067 108.242 55.365C108.151 53.0822 108.215 50.7958 108.431 48.5215H94.9873Z"
              fill="#ED9DA0"
            />
            <path
              d="M102.277 55.0964C108.657 55.0964 113.828 49.9048 113.828 43.5006C113.828 37.0964 108.657 31.9048 102.277 31.9048C95.8977 31.9048 90.7261 37.0964 90.7261 43.5006C90.7261 49.9048 95.8977 55.0964 102.277 55.0964Z"
              fill="#ED9DA0"
            />
            <path
              d="M101.615 68.6718L90.6322 58.5967C90.6322 58.5967 85.7087 62.7787 85.1406 62.7787C84.5726 62.7787 77.1874 65.0599 76.9979 66.0118C76.8084 66.9637 83.4363 77.0374 83.4363 77.0374C83.4363 77.0374 81.9214 84.4511 83.4363 87.6827C84.9511 90.9143 83.815 104.792 83.815 104.792C83.815 104.792 93.8514 101.18 99.1534 102.891C104.455 104.602 119.983 102.891 119.983 102.891C119.983 102.891 122.256 88.2538 121.309 86.354C120.362 84.4543 120.173 73.6175 120.173 73.6175L128.315 64.6831C128.315 64.6831 126.611 57.8396 120.173 57.4594C113.734 57.0791 109.758 56.6989 109.758 56.6989L101.615 68.6718Z"
              fill="#FCF6BD"
            />
            <path
              d="M88.7382 115.435C88.7382 115.435 67.5295 105.741 59.0079 101.178C50.4864 96.616 37.4204 100.228 41.5864 110.493C45.7524 120.758 69.0443 130.833 69.0443 130.833C69.0443 130.833 76.6187 136.536 81.1635 136.346C85.7083 136.156 92.2413 136.251 92.2413 136.251L88.7382 115.435Z"
              fill="#090814"
            />
            <path
              d="M121.498 116.766C121.498 116.766 159.56 117.146 157.099 131.403C154.637 145.661 140.055 169.422 137.404 169.993C134.754 170.563 125.096 166.381 125.096 165.05C125.096 163.72 134.375 139.197 134.375 139.197L111.651 132.164L121.498 116.766Z"
              fill="#090814"
            />
            <path
              d="M128.694 74.1849C128.694 74.1849 130.966 96.0458 129.83 99.4677C128.694 102.89 124.717 112.204 119.605 116.766C114.492 121.328 107.296 144.33 103.319 133.303C99.3429 122.277 109.758 116.194 109.758 116.194L120.198 101.449L120.295 77.454L128.694 74.1849Z"
              fill="#ED9DA0"
            />
            <path
              d="M86.0875 119.998C86.0875 119.998 104.835 126.651 106.917 125.7C109 124.75 113.545 128.171 113.545 128.171C115.645 127.72 117.814 127.689 119.926 128.081C122.038 128.472 124.053 129.278 125.854 130.453C131.913 134.445 133.239 139.007 131.913 139.197C130.588 139.387 125.854 137.296 125.854 137.296C125.854 137.296 118.658 135.775 114.303 137.106C109.947 138.437 104.27 135.632 104.27 135.632L81.1633 130.453L86.0875 119.998Z"
              fill="#ED9DA0"
            />
            <path
              d="M124.34 62.3985L128.317 64.6797C128.317 64.6797 129.832 74.7548 130.589 76.0855C131.347 77.4162 121.31 80.8378 119.795 79.8873C118.28 78.9369 117.523 69.6222 117.523 69.6222L124.34 62.3985Z"
              fill="#FCF6BD"
            />
            <path
              opacity={0.1}
              d="M60.4285 104.79C60.4285 104.79 71.9797 109.733 75.1989 110.493C78.4181 111.253 88.8224 120.151 88.8224 120.151L81.7202 130.977C81.7202 130.977 74.441 130.073 70.4646 129.312C66.4881 128.552 42.8186 112.775 46.7942 110.112C50.7698 107.45 60.4285 104.79 60.4285 104.79Z"
              fill="black"
            />
            <path
              d="M58.0612 104.79C58.0612 104.79 69.6124 109.733 72.8316 110.493C76.0508 111.253 88.7383 119.998 88.7383 119.998L82.4895 132.164C82.4895 132.164 72.0743 130.073 68.0965 129.312C64.1186 128.552 40.4505 112.775 44.4261 110.113C48.4017 107.45 58.0612 104.79 58.0612 104.79Z"
              fill="#090814"
            />
            <path
              d="M103.287 42.6783C109.723 42.6783 114.94 37.4412 114.94 30.9809C114.94 24.5207 109.723 19.2836 103.287 19.2836C96.8519 19.2836 91.635 24.5207 91.635 30.9809C91.635 37.4412 96.8519 42.6783 103.287 42.6783Z"
              fill="#090814"
            />
            <path
              d="M107.249 24.7884C110.649 24.7884 113.405 22.0217 113.405 18.6089C113.405 15.1961 110.649 12.4295 107.249 12.4295C103.85 12.4295 101.094 15.1961 101.094 18.6089C101.094 22.0217 103.85 24.7884 107.249 24.7884Z"
              fill="#090814"
            />
            <path
              d="M120.907 82.3296L109.165 80.8823C108.54 80.8052 107.971 81.2514 107.895 81.8787L104.876 106.554C104.8 107.181 105.244 107.752 105.869 107.829L117.611 109.276C118.236 109.353 118.805 108.907 118.882 108.28L121.9 83.605C121.976 82.9776 121.532 82.4066 120.907 82.3296Z"
              fill="#090814"
            />
            <path
              d="M114.033 89.8073C115.322 89.9662 116.495 89.0459 116.654 87.7519C116.812 86.4578 115.895 85.28 114.606 85.1211C113.317 84.9622 112.144 85.8824 111.985 87.1765C111.827 88.4705 112.744 89.6484 114.033 89.8073Z"
              fill="#FCF6BD"
            />
            <path
              d="M76.9978 82.3588C76.9978 82.3588 77.1871 105.931 80.0277 108.782C82.8684 111.633 100.849 110.193 100.849 110.193C100.849 110.193 112.201 112.037 116.953 105.478C122.32 98.0674 102.862 104.13 102.862 104.13C102.862 104.13 88.9608 104.831 88.1693 104.22C85.7077 102.319 85.1394 81.4083 85.1394 81.4083L76.9978 82.3588Z"
              fill="#ED9DA0"
            />
            <path
              d="M79.4595 65.8204H76.9979C76.9979 65.8204 74.3473 68.6718 74.5363 74.7548C74.7252 80.8378 72.2639 84.6397 73.7787 85.2102C75.2935 85.7807 82.85 82.7619 82.7642 83.606C82.6784 84.45 86.6552 82.9293 86.6552 82.9293L84.0046 72.8542L79.4595 65.8204Z"
              fill="#FCF6BD"
            />
            <path
              d="M151.138 29.14C151.126 29.1464 151.115 29.1536 151.103 29.1602C150.607 28.307 149.798 27.6827 148.85 27.4217C147.901 27.1607 146.888 27.2837 146.029 27.7643C145.166 28.2471 144.527 29.0515 144.251 30.0034C143.975 30.9553 144.083 31.9781 144.552 32.8505L144.577 32.8948L148.213 39.4395L154.776 35.7643L154.765 35.7454C154.776 35.7395 154.787 35.7342 154.799 35.7282C155.669 35.2409 156.311 34.4266 156.583 33.4644C156.855 32.5021 156.735 31.4708 156.25 30.5972C155.765 29.7236 154.953 29.0794 153.995 28.8062C153.036 28.5331 152.008 28.6534 151.138 29.1408L151.138 29.14Z"
              fill="#FCF6BD"
            />
            <path
              d="M132.641 14.6971C132.633 14.7079 132.627 14.719 132.618 14.7306C131.8 14.1818 130.801 13.9769 129.834 14.16C128.868 14.343 128.011 14.8994 127.449 15.7096C126.884 16.5231 126.662 17.527 126.829 18.5041C126.997 19.4811 127.541 20.3526 128.344 20.93L128.385 20.959L134.511 25.2396L138.803 19.0485L138.785 19.0362C138.793 19.026 138.801 19.0163 138.809 19.0057C139.378 18.1848 139.599 17.1706 139.423 16.1862C139.247 15.2017 138.689 14.3277 137.871 13.7563C137.054 13.1849 136.043 12.9631 135.062 13.1396C134.082 13.3161 133.211 13.8765 132.642 14.6975L132.641 14.6971Z"
              fill="#FCF6BD"
            />
            <path
              d="M153.873 1.40235C153.863 1.411 153.854 1.42026 153.843 1.42942C153.182 0.698339 152.261 0.256794 151.279 0.199666C150.297 0.142539 149.332 0.474388 148.591 1.12391C147.847 1.77621 147.39 2.69626 147.317 3.68494C147.244 4.67361 147.561 5.65136 148.201 6.40658L148.234 6.44471L153.147 12.086L158.804 7.12109L158.789 7.10487C158.799 7.09678 158.809 7.08927 158.819 7.08094C159.569 6.4226 160.028 5.49218 160.095 4.49431C160.161 3.49644 159.831 2.51282 159.175 1.7598C158.519 1.00678 157.592 0.546148 156.598 0.47923C155.604 0.412312 154.624 0.744589 153.874 1.40297L153.873 1.40235Z"
              fill="#FCF6BD"
            />
          </g>
          <defs>
            <clipPath id="clip0_12_740">
              <rect width={198} height={206} fill="white" />
            </clipPath>
          </defs>
        </svg>
        {title && <h2 className="text-lg font-bold mb-4">{title}</h2>}

        <div className="mb-6">{children}</div>

        <div className="flex gap-3 justify-end pb-10">
          <Button color="pink" shape="shape2" action={onClose} noForm={true}>
            {cancelText}
          </Button>
          <Button color="green" action={onConfirm} noForm={true}>
            {confirmText}
          </Button>
        </div>
        <Divider />
      </div>
    </div>
  );
}
